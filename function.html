---
layout: default
---
 
<h2>Functions</h2> 
<hr>  
<hr> <p>
<br><h7 style='font-weight:bold;'>&#11166;Functions for defining the computational domain</h7>
<br> <a href="/mSOUND/function.html#set_grid">set_grid</a>
 <br>
<br><h7 style='font-weight:bold;'>&#11166;Functions for forward projection</h7>
<br> <a href="/mSOUND/function.html#Forward1D">Forward1D</a>
<br> <a href="/mSOUND/function.html#Forward2D">Forward2D</a>
<br> <a href="/mSOUND/function.html#Forward3D">Forward3D</a> 
<br> <a href="/mSOUND/function.html#Forward2D_fund">Forward2D_fund</a>
<br> <a href="/mSOUND/function.html#Forward2D_sec">Forward2D_sec</a> 
<br> <a href="/mSOUND/function.html#Forward3D_fund">Forward3D_fund</a>
<br> <a href="/mSOUND/function.html#Forward3D_sec">Forward3D_sec</a> 
<br>
<br><h7 style='font-weight:bold;'>&#11166;Functions for backward projection</h7>
<br> <a href="/mSOUND/function.html#Backward1D">Backward1D</a>
<br> <a href="/mSOUND/function.html#Backward2D">Backward2D</a>
<br> <a href="/mSOUND/function.html#Backward3D">Backward3D</a> 
<br> <a href="/mSOUND/function.html#Backward2D_fund">Backward2D_fund</a>
<br> <a href="/mSOUND/function.html#Backward3D_fund">Backward3D_fund</a>
</p>

<hr>
<hr>
<a id="set_grid"></a>  

<h3 style="color: #c64949;">set_grid </h3>         
<hr>   
<p>
<a href="/mSOUND/function.html#set_grid">set_grid</a>
 is the grid class used in mSOUND and it generates a structure containing the Cartesian grid coordinates, 	
evenly spaced time array and wavenumber matrices used within the simulation.

<pre> <code>
mgrid = set_grid(dt, t_length, dx, x_length);   <font color="#03a852">% 1D</font>                         
mgrid = set_grid(dt, t_length, dx, x_length, dy, y_length);  <font color="#03a852">% 2D</font>      
mgrid = set_grid(dt, t_length, dx, x_length, dy, y_length, dz, z_length);  <font color="#03a852">% 3D</font>      
</code> </pre>
</p>

<h3>Inputs </h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>dx</td><td>spatial step size in the x direction [m]</td>
  </tr>
  <tr>
    <td>dy</td><td>spatial step size in the y direction [m]</td>
  </tr>
  <tr>
    <td>dz</td><td>spatial step size in the z direction [m]</td>
  </tr>
  <tr>
    <td>dt</td><td>temporal step size [s]</td>
  </tr>
  <tr>
    <td>x_length</td><td>spatial domain size in the x direction [m]</td>
  </tr>  
  <tr>
    <td>y_length</td><td>spatial domain size in the y direction [m]</td>
  </tr>    
  <tr>
    <td>z_length</td><td>spatial domain size in the z direction [m]</td>
  </tr>      
  <tr>
    <td>t_length</td><td>temporal domain size [s]</td>
  </tr> 
 </table> 

<br>       

<h3>Outputs</h3> 
<table>
  <tr>
    <th>OUTPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid.x</td><td>coordinates in the x direction [m] </td>
  </tr>
  <tr>
    <td>mgrid.y</td><td>coordinates in the y direction [m] </td>
  </tr>
  <tr>
    <td>mgrid.z</td><td>coordinates in the z direction [m] </td>
  </tr>
  <tr>
    <td>mgrid.t</td><td>evenly spaced time array [s]</td>
  </tr>
  <tr>
    <td>mgrid.kx</td><td>wavevector in the x direction</td>
  </tr>  
  <tr>
    <td>mgrid.ky</td><td>wavevector in the y direction</td>
  </tr>    
  <tr>
    <td>mgrid.w</td><td>angular frequency</td>
  </tr>      
  <tr>
    <td>mgrid.num_x</td><td>number of grid points in the x direction</td>
  </tr> 
  <tr>
    <td>mgrid.num_y</td><td>number of grid points in the y direction</td>
  </tr> 
  <tr>
    <td>mgrid.num_z</td><td>number of grid points in the z direction</td>
  </tr> 
  <tr>
    <td>mgrid.num_t</td><td>number of sampling point in time</td>
  </tr>
 </table> 
<br>

<a id="Forward1D"></a>
<h3 style="color: #c64949;">Forward1D </h3>   

<hr>
<p>
 <a href="/mSOUND/function.html#Forward1D">Forward1D</a>
 is a 1D forward simulation function based on the transient mixed domain method and it generates time-domain results.
<pre> <code>
p = Forward1D(mgrid, medium, source_p, sensor_mask, reflection_order);  
p = Forward1D(mgrid, medium, source_p, sensor_mask, reflection_order, ...);  
</code>  </pre>
</p>

<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the medium properties</td>
  </tr>
   <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the waveform is recorded</td>
  </tr>
  <tr>
   <td>reflection_order</td><td>the maximum order of reflection included in the simulation</td>
  </tr> 
 </table> 
<br>
<table>
  <tr>
   <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
   <td>'correction'</td><td>apply phase and amplitude corrections for strongly heterogeneous media</td>
  </tr>
 </table> 

<br> 
<h3> Remarks </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 1D simulations, the medium properties should be given as matrices with a size (1, mgrid.num_x+1).
 For homogeneous media, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 <br><br>2. The excitation pressure <span style="background-color:#f1f1f1">source_p</span> is indexed as (time, source_position). 
 <br><br>3. <span style="background-color:#f1f1f1">sensor_mask</span>
 contains the positions in Cartesian coordinate with a matrix size (1, mgrid.num_x+1)
 with the recording positions marked with logical value 1 while other positions are marked with 0. 
 <br><br>4. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflection to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 <br><br>5. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
</p>

<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by <span style="background-color:#f1f1f1">sensor_mask</span>.
 </pr>

<a id="Forward2D"></a>
<h3 style="color: #c64949;">Forward2D  </h3>   
<hr>
<p>
 <a href="/mSOUND/function.html#Forward2D">Forward2D</a>
 is a 2D forward simulation function based on the transient mixed domain method and it generates time-domain results.
 
<pre>  <code>
p = Forward2D(mgrid, medium, source_p, sensor_mask, reflection_order); 
p = Forward2D(mgrid, medium, source_p, sensor_mask, reflection_order, ...); 
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the medium properties</td>
  </tr>
   <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the waveform is recorded</td>
  </tr>
   <tr>
   <td>reflection_order</td><td>the maximum order of reflection included in the simulation</td>
  </tr> 
 </table> 
<br>
<table>
  <tr>
  <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
  <td>'correction'</td><td>apply phase and amplitude corrections for strongly heterogeneous media</td>
  </tr>
   <tr>
  <td>'NRL'</td><td>apply the non-reflecting layer</td>
  </tr>
  <tr>
  <td>'animation'</td><td>play the animation during the simulation</td>
  </tr>
  <tr>
  <td>'record_animation'</td><td>record the animation</td>
  </tr> 
 </table> 

<br> 
<h3> Remarks </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 2D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y+1).
 For homogeneous media, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 
 <br><br>2. The excitation pressure <span style="background-color:#f1f1f1">source_p</span> is indexed as (time, source_position). 
 
 <br><br>3. <span style="background-color:#f1f1f1">sensor_mask</span>
 contains the positions in Cartesian coordinate with a matrix size (mgrid.num_x, mgrid.num_y+1)
 with the recording positions marked with logical value 1 while other positions are marked with 0. 
 
 <br><br>4. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflection to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 
 <br><br>5. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 
 <br><br>6. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given. 
 
 <br><br>7. <span style="background-color:#f1f1f1">record_animation</span> will record the animation and save the animation 
 file as ‘animation.avi’.

 

</p>

<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by <span style="background-color:#f1f1f1">sensor_mask</span>.
 </pr>


<a id="Forward3D"></a>
<h3 style="color: #c64949;">Forward3D</h3>     
<hr>
<p>
 <a href="/mSOUND/function.html#Forward3D">Forward3D</a>
 is a 3D forward simulation function based on the transient mixed domain method and it generates time-domain results. 
<pre>  <code>
p = Forward3D(mgrid, medium, source_p, sensor_mask, reflection_order);
p = Forward3D(mgrid, medium, source_p, sensor_mask, reflection_order, ...);
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the medium properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr> 
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the waveform is recorded</td>
  </tr>
   <tr>
   <td>reflection_order</td><td>the maximum order of reflection included in the simulation</td>
  </tr> 
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strongly heterogeneous media</td>
  </tr>
   <tr>
  <td>'NRL'</td><td>apply the non-reflecting layer</td>
  </tr>
   <tr>
  <td>'animation'</td><td>play the animation during the simulation</td>
  </tr>
  <tr>
  <td>'record_animation'</td><td>record the animation</td>
  </tr> 
 </table> 

<br> 
<h3> Remarks </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 3D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y, mgrid.num_z+1).
 For homogeneous media, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 
 <br><br>2. The excitation pressure <span style="background-color:#f1f1f1">source_p</span> is indexed as (time, source_position). 
 
 <br><br>3. <span style="background-color:#f1f1f1">sensor_mask</span>
 contains the positions in Cartesian coordinate with a matrix size (mgrid.num_x, mgrid.num_y, mgrid.num_z+1)
 with the recording positions marked with logical value 1 while other positions are marked with 0. 
 
 <br><br>4. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflection to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 
 <br><br>5. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 
 <br><br>6. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given.
 
 <br><br>7. <span style="background-color:#f1f1f1">record_animation</span> will record the animation and save the animation 
 file as ‘animation.avi’.
 
 
</p>

<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by <span style="background-color:#f1f1f1">sensor_mask</span>.
 </pr>


<a id="Forward2D_fund"></a>
<h3 style="color: #c64949;">Forward2D_fund</h3>     
<hr>
<p>
 <a href="/mSOUND/function.html#Forward2D_fund">Forward2D_fund</a>
 is a 2D forward simulation function based on the frequency-specific mixed domain method and it
 generates the pressure field at the center frequency. Only use this function when the excitation is a continuous wave (sinusoidal wave) and 
 linear or weakly nonlinear wave propagation is considered. 
<pre>  <code>
p = Forward2D_fund(mgrid, medium, source_p, omega_c, reflection_order);  
p = Forward2D_fund(mgrid, medium, source_p, omega_c, reflection_order, ...);  
</code>  </pre>
</p>

<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium</td><td>input structure including the medium properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
   <tr>
    <td>omega_c </td><td>center frequency [rad]</td>
  </tr>
   <tr>
   <td>reflection_order</td><td>the maximum order of reflection included in the simulation</td>
  </tr> 
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>PROPERTIES</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strongly heterogeneous media</td>
  </tr>
   <tr>
  <td>'NRL'</td><td>apply the non-reflecting layer</td>
  </tr>
 
 </table> 

<br> 
<h3> Remarks </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 2D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y+1).
 For homogeneous media, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 
 <br><br>2. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflection to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 
 <br><br>3. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 
 <br><br>4. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given.

</p>
  
<h3>Outputs</h3> 
<p>
Pressure field distribution at the center frequency.      
</pr>


<a id="Forward2D_sec"></a>
<h3 style="color: #c64949;">Forward2D_sec</h3>    
<hr>
<p>
 <a href="/mSOUND/function.html#Forward2D_sec">Forward2D_sec</a>
is a 2D forward simulation function based on the frequency-specific mixed domain method and it
 generates the pressure field at the second harmonics. 
 To generate the second harmonics pressure field, 
 users must run the function <a href="/mSOUND/function.html#Forward2D_fund">Forward2D_fund</a> first to 
obtain the pressure field at the center frequency <span style="background-color:#f1f1f1">P_fundamental</span>. 
 When calculating the second harmonics pressure field, density heterogeneity is by dafault not considered. 
 It can be considered, however, by invoking "correction". Only use this function when the excitation is a continuous wave (sinusoidal wave) and
  weakly nonlinear wave propagation is considered. Multiple reflections are not consdiered in this function. 
<pre>  <code>
p = Forward2D_sec(mgrid, medium, P_fundamental, omega_c);  
p = Forward2D_sec(mgrid, medium, P_fundamental, omega_c, ...);  
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the medium properties</td>
  </tr>
  <tr>
    <td>P_fundamental</td><td>pressure at the center frequency  [Pa]</td>
  </tr>
   <tr>
    <td>omega_c </td><td>center frequency [rad]</td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strongly heterogeneous media</td>
  </tr>
   <tr>
  <td>'NRL'</td><td>apply the non-reflecting layer</td>
  </tr>
 
 </table> 
<br> 
<h3> Remarks </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 2D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y+1).
 For homogeneous media, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 
 <br><br>2. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 
 <br><br>3. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given. 
 
  
</p>

<h3>Outputs</h3> 
<p>
Pressure field distribution at the second harmonics.    
</pr>


<a id="Forward3D_fund"></a>
<h3 style="color: #c64949;">Forward3D_fund</h3>   
<hr>
<p>
<a href="/mSOUND/function.html#Forward3D_fund">Forward3D_fund</a>
is a 3D forward simulation function based on the frequency-specific mixed domain method and it
generates the pressure field at the center frequency. Only use this function when the excitation is a continuous wave (sinusoidal wave) 
 and linear or weakly nonlinear wave propagation is considered. 
<pre>  <code>
p = Forward3D_fund(mgrid, medium, source_p, omega_c);  
p = Forward3D_fund(mgrid, medium, source_p, omega_c, reflection_order);  
p = Forward3D_fund(mgrid, medium, source_p, omega_c, reflection_order, c_ref, ...);  

</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the medium properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>excitation signal [Pa]</td>
  </tr>
  <tr>
    <td>omega_c </td><td>center frequency [rad]</td>
  </tr>
  <tr>
   <td>reflection_order</td><td>the maximum order of reflection included in the simulation</td>
  </tr> 
  <tr>
   <td>c_ref</td><td>a set of reference sound velocities covering the sound velocity distribution of the medium </td>
  </tr>
</table> 
<br>
<table>
<tr>
<th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
</tr>
<tr>
<td>'correction'</td><td>use the wave solver for strongly inhomogeneous media</td>
</tr>
 <tr>
<td>'layer'</td><td>use the wave solver for layered media</td>
</tr>
  <tr>
  <td>'riemann'</td><td>use a lower order numerical scheme for faster computation</td>
  </tr>
   <tr>
  <td>'NRL'</td><td>apply the non-reflecting layer</td>
  </tr>
  <tr>
  <td>'single'</td><td>cast data type to single to reduce data size and speed up the computation</td>
  </tr>
 
</table> 

<br> 
<h3> Remarks </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 3D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y, mgrid.num_z).
 For homogeneous media, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the background speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 
 <br><br>2. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflection to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 
 <br><br>3. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 
  <br><br>4. <span style="background-color:#f1f1f1">layer</span> should only be used when the layer interface is perpendicular to the z-axis. 
 This function is applicable to arbitrary inhomogeneities. 
 
 <br><br>5. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given. 
 
  
</p>
  
<h3>Outputs</h3> 

<p>
Pressure field distribution at the center frequency.    
</pr>


<a id="Forward3D_sec"></a>
<h3 style="color: #c64949;">Forward3D_sec</h3>   
<hr>
<p>
<a href="/mSOUND/function.html#Forward3D_sec">Forward3D_sec</a>
is a 3D forward simulation function based on the frequency-specific mixed domain method and it
 generates the pressure field at the second harmonics. 
 To generate the second harmonics pressure field, 
 users must run the function <a href="/mSOUND/function.html#Forward3D_fund">Forward3D_fund</a> first to 
obtain the pressure field at the fundamental frequency <span style="background-color:#f1f1f1">P_fundamental</span>. 
 Only use this function when the excitation is a continuous wave (sinusoidal wave) and
  weakly nonlinear wave propagation is considered. Multiple reflections are currently not considered in this function. 
<pre>  <code>
p = Forward3D_sec(mgrid, medium, P_fundamental, omega_c);   
p = Forward3D_sec(mgrid, medium, P_fundamental, omega_c, c_ref, ...);   
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the medium properties</td>
  </tr>
  <tr>
    <td>P_fundamental</td><td>pressure at the fundamental frequency  [Pa]</td>
  </tr>
   <tr>
    <td>omega_c </td><td>fundamental frequency [rad]</td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
 <tr>
<td>'correction'</td><td>use the wave solver for strongly inhomogeneous media</td>
</tr>
     <tr>
   <td>c_ref</td><td>a set of reference sound velocities covering the sound velocity distribution of the medium </td>
  </tr>
   <tr>
  <td>'NRL'</td><td>apply the non-reflecting layer</td>
  </tr> 
 <tr>
  <td>'riemann'</td><td>use a lower order numerical scheme for faster computation</td>
  </tr>
   <tr>
  <td>'single'</td><td>cast data type to single to reduce data size and speed up the computation</td>
  </tr>
 </table> 

<br> 
<h3> Remarks </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 3D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y, mgrid.num_z).
 For homogeneous media, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the background speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 
 <br><br>2. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 
 <br><br>3. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given. 
 
 
</p>

<h3>Outputs</h3> 
<p>
Pressure field distribution at the second harmonics.    
</pr>


<a id="Backward1D"></a>
<h3 style="color: #c64949;">Backward1D </h3>   
<hr>
<p>
 <a href="/mSOUND/function.html#Backward1D">Backward1D</a>
 is a 1D backward simulation function based on the transient mixed domain method and it generates time-domain results.
<pre> <code>
p = Backward1D(mgrid, medium, source_p, sensor_mask, reflection_order);  
p = Backward1D(mgrid, medium, source_p, sensor_mask, reflection_order, ...);  
</code>  </pre>
</p>

<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the medium properties</td>
  </tr>
   <tr>
    <td>source_p</td><td>pressure field to be backward propagated</td>
  </tr>
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the waveform is recorded</td>
  </tr>
   <tr>
    <td>reflection_order</td><td>the maximum order of reflection included in the simulation</td>
  </tr>
 </table> 

<br>
<table>
  <tr>
   <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
   <td>'correction'</td><td>apply phase and amplitude corrections for strongly heterogeneous media</td>
  </tr>
  <tr>
   <td>'no_refl_correction'</td><td>turn off the reflection correction in backward propagation</td>
  </tr> 
 </table> 

<br> 
<h3> Remarks </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 1D simulations, the medium properties should be given as matrices with a size (mgrid.num_x+1, 1).
 For homogeneous media, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 
 <br><br>2. The excitation pressure <span style="background-color:#f1f1f1">source_p</span> is indexed as (time, source_position). 
 
 <br><br>3. <span style="background-color:#f1f1f1">sensor_mask</span>
 contains the positions in Cartesian coordinate with a matrix size (mgrid.num_x+1, 1)
 with the recording positions marked with logical value 1 while other positions are marked with 0. 
 
 <br><br>4. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflection to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 
 <br><br>5. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 
 <br><br>6. For a heterogeneous medium, when using full-wave-solver-generated data or measured data as the input for backward projection, the mixed domain method could 
 produce spurious reflections. An algorithm, therefore, is designed to mitigate this issue. This correction algorithm, 
 however, roughly doubles the computational time. There are a few scenarios where this correction algorithm can be disabled without 
 sacrificing much of the accuracy. This can be done by activating "no_refl_correction". For example, when multiple reflection is 
 not considered in the backward projection, i.e., when "reflection_order"=0, the correction algorithm can be turned off. 
 Even if "reflection_order" is not equal to 0, the correction algorithm can be turned off for weakly heterogeneous media such as 
 soft tissue. When the speed of sound and density are constants, the correcton algorithm will be turned off automatically.
</p>

<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by <span style="background-color:#f1f1f1">sensor_mask</span>.
 </pr>

<a id="Backward2D"></a>
<h3 style="color: #c64949;">Backward2D  </h3>   
<hr>
<p>
 <a href="/mSOUND/function.html#Backward2D">Backward2D</a>
 is a 2D backward simulation function based on the transient mixed domain method and it generates time-domain results.
<pre>  <code>
p = Backward2D(mgrid, medium, source_p, sensor_mask, reflection_order); 
p = Backward2D(mgrid, medium, source_p, sensor_mask, reflection_order, ...); 
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the medium properties</td>
  </tr>
   <tr>
    <td>source_p</td><td>pressure field to be backward propagated</td>
  </tr>
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the waveform is recorded</td>
  </tr>
    <tr>
    <td>reflection_order</td><td>the maximum order of reflection included in the simulation</td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strongly heterogeneous media</td>
  </tr>
    <tr>
   <td>'no_refl_correction'</td><td>turn off the reflection correction in backward propagation</td>
  </tr>
   <tr>
  <td>'NRL'</td><td>apply the non-reflecting layer</td>
  </tr>
   <tr>
  <td>'animation'</td><td>play the animation during the simulation</td>
  </tr>
  <tr>
  <td>'record_animation'</td><td>record the animation</td>
  </tr> 
 </table> 

<br> 
<h3> Remarks </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 2D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y+1).
 For homogeneous media, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 
 <br><br>2. The excitation pressure <span style="background-color:#f1f1f1">source_p</span> is indexed as (time, source_position). 
 
 <br><br>3. <span style="background-color:#f1f1f1">sensor_mask</span>
 contains the positions in Cartesian coordinate with a matrix size (mgrid.num_x, mgrid.num_y+1)
 with the recording positions marked with logical value 1 while other positions are marked with 0. 
 
 <br><br>4. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflection to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 
 <br><br>5. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 
 <br><br>6. For a heterogeneous medium, when using full-wave-solver-generated data or measured data as the input for backward projection, the mixed domain method could 
 produce spurious reflections. An algorithm, therefore, is designed to mitigate this issue. This correction algorithm, 
 however, roughly doubles the computational time. There are a few scenarios where this correction algorithm can be disabled without 
 sacrificing much of the accuracy. This can be done by activating "no_refl_correction". For example, when multiple reflection is 
 not considered in the backward projection, i.e., when "reflection_order"=0, the correction algorithm can be turned off. 
 Even if "reflection_order" is not equal to 0, the correction algorithm can be turned off for weakly heterogeneous media such as 
 soft tissue. When the speed of sound and density are constants, the correcton algorithm will be turned off automatically.
 
 <br><br>7. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given. 
 
 <br><br>8. <span style="background-color:#f1f1f1">record_animation</span> will record the animation and save the animation 
 file as ‘animation.avi’.
</p>

<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by <span style="background-color:#f1f1f1">sensor_mask</span>.
 </pr>

<a id="Backward3D"></a>
<h3 style="color: #c64949;">Backward3D</h3>     
<hr>
<p>
 <a href="/mSOUND/function.html#Backward3D">Backward3D</a>
 is a 3D backward simulation function based on the transient mixed domain method and it generates time-domain results. 
<pre>  <code>
p = Backward3D(mgrid, medium, source_p, sensor_mask, reflection_order);
p = Backward3D(mgrid, medium, source_p, sensor_mask, reflection_order, ...);
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the medium properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>pressure field to be backward propagated</td>
  </tr> 
  <tr>
    <td>sensor_mask</td><td>a set of Cartesian points where the waveform is recorded</td>
  </tr>
    <tr>
    <td>reflection_order</td><td>the maximum order of reflection included in the simulation</td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strongly heterogeneous media</td>
  </tr>
   <tr>
  <td>'no_refl_correction'</td><td>turn off the reflection correction in backward propagation</td>
  </tr> 
   <tr>
<td>'NRL'</td><td>apply the non-reflecting layerr</td>
  </tr>
   <tr>
  <td>'animation'</td><td>play the animation during the simulation</td>
  </tr>
  <tr>
  <td>'record_animation'</td><td>record the animation</td>
  </tr> 
 </table> 

<br> 
<h3> Remarks </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 3D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y, mgrid.num_z+1).
 For homogeneous media, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 
 <br><br>2. The excitation pressure <span style="background-color:#f1f1f1">source_p</span> is indexed as (time, source_position). 
 
 <br><br>3. <span style="background-color:#f1f1f1">sensor_mask</span>
 contains the positions in Cartesian coordinate with a matrix size (mgrid.num_x, mgrid.num_y, mgrid.num_z+1)
 with the recording positions marked with logical value 1 while other positions are marked with 0. 
 
 <br><br>4. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflection to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 
 <br><br>5. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 
 <br><br>6. For a heterogeneous medium, when using full-wave-solver-generated data or measured data as the input for backward projection, the mixed domain 
 method could produce spurious reflections. An algorithm, therefore, is designed to mitigate this issue. This correction 
 algorithm, however, roughly doubles the computational time. There are a few scenarios where this correction algorithm can be 
 disabled without sacrificing much of the accuracy. This can be done by activating "no_refl_correction". For example, 
 when multiple reflection is not considered in the backward projection, i.e., when "reflection_order"=0, the correction algorithm 
 can be turned off. Even if "reflection_order" is not equal to 0, the correction algorithm can be turned off for weakly 
 heterogeneous media such as soft tissue. 
 When the speed of sound and density are constants, the correcton algorithm will be turned off automatically.
 
 <br><br>7. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given. 
 
 <br><br>8. <span style="background-color:#f1f1f1">record_animation</span> will record the animation and save the animation 
 file as ‘animation.avi’.
</p>
 
<h3>Outputs</h3> 
<p>
Time-domain results recorded at the sensor positions given by <span style="background-color:#f1f1f1">sensor_mask</span>.
 </pr>

<a id="Backward2D_fund"></a>
<h3 style="color: #c64949;">Backward2D_fund</h3>     
<hr>
<p>
 <a href="/mSOUND/function.html#Backward2D_fund">Backward2D_fund</a>
 is a 2D backward simulation function based on the frequency-specific mixed domain method and it
 generates the pressure field at the center frequency. Only use this function when the excitation is 
 a continuous wave (sinusoidal wave) and linear wave propagation is considered. 
<pre>  <code>
p = Backward2D_fund(mgrid, medium, source_p, omega_c, reflection_order);  
p = Backward2D_fund(mgrid, medium, source_p, omega_c, reflection_order...);  
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the medium properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>pressure field to be backward propagated</td>
  </tr>
   <tr>
    <td>omega_c </td><td>center frequency [rad]</td>
  </tr>
    <tr>
    <td>reflection_order</td><td>the maximum order of reflection included in the simulation</td>
  </tr>
 </table> 
<br>
<table>
  <tr>
    <th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>'correction'</td><td>apply phase and amplitude corrections for strongly heterogeneous media</td>
  </tr>
   <tr>
<td>'no_refl_correction'</td><td>turn off the reflection correction in backward propagation</td>
  </tr> 
   <tr>
  <td>'NRL'</td><td>apply the non-reflecting layerr</td>
  </tr>
 </table> 


<br> 
<h3> Remarks </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 2D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y+1).
 For homogeneous media, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 
 <br><br>2. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflection to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 
 <br><br>3. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.
 
 <br><br>4. For a heterogeneous medium, when using full-wave-solver-generated data or measured data as the input for backward projection, the mixed domain 
 method could produce spurious reflections. An algorithm, therefore, is designed to mitigate this issue. This correction 
 algorithm, however, roughly doubles the computational time. There are a few scenarios where this correction algorithm can be 
 disabled without sacrificing much of the accuracy. This can be done by activating "no_refl_correction". For example, 
 when multiple reflection is not considered in the backward projection, i.e., when "reflection_order"=0, the correction algorithm 
 can be turned off. Even if "reflection_order" is not equal to 0, the correction algorithm can be turned off for weakly 
 heterogeneous media such as soft tissue. 
 When the speed of sound and density are constants, the correcton algorithm will be turned off automatically.
 
 <br><br>5. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given. 
</p>
 
<h3>Outputs</h3> 
<p>
Pressure field distribution at the center frequency.      
</pr>

<a id="Backward3D_fund"></a>
<h3 style="color: #c64949;">Backward3D_fund</h3>   
<hr>
<p>
<a href="/mSOUND/function.html#Backward3D_fund">Backward3D_fund</a>
is a 3D backward simulation function based on the frequency-specific mixed domain method and it
generates the pressure field at the center frequency. Only use this function when the excitation is 
 a continuous wave (sinusoidal wave) and linear wave propagation is considered. 
<pre>  <code>
p = Backward3D_fund(mgrid, medium, source_p, omega_c, reflection_order);  
p = Backward3D_fund(mgrid, medium, source_p, omega_c, reflection_order, ...);  
</code>  </pre>
</p>
<h3>Inputs</h3> 
<table>
  <tr>
    <th>INPUT</th><th>DESCRIPTION</th>
  </tr>
  <tr>
    <td>mgrid</td><td>structure returned by set_grid</td>
  </tr>
  <tr>
    <td>medium </td><td>input structure including the medium properties</td>
  </tr>
  <tr>
    <td>source_p</td><td>pressure field to be backward propagated</td>
  </tr>
   <tr>
    <td>omega_c </td><td>center frequency [rad]</td>
  </tr>
    <tr>
    <td>reflection_order</td><td>the maximum order of reflection included in the simulation</td>
  </tr>
 </table> 
<br>
<table>
<tr>
<th>OPTIONAL INPUT</th><th>DESCRIPTION</th>
</tr>
<tr>
<td>'correction'</td><td>apply phase and amplitude corrections for strongly heterogeneous media</td>
</tr>
  <tr>
 <td>'no_refl_correction'</td><td>turn off the reflection correction in backward propagation</td>
  </tr> 
  <tr>
<td>'NRL'</td><td>apply the non-reflecting layer</td>
  </tr>
</table> 

<br> 
<h3> Details </h3>         
<hr>   
<p>
1. <span style="background-color:#f1f1f1">medium</span> 
 is a structure containing spatially distributed speed of sound, density, nonlinear coefficient, 
 attenuation coefficient, and power law exponent.  
 For 3D simulations, the medium properties should be given as matrices with a size (mgrid.num_x, mgrid.num_y, mgrid.num_z+1).
 For homogeneous media, the medium properties can be described by a single scalar. 
 <span style="background-color:#f1f1f1">medium.c0</span> 
 is the reference speed of sound and generally, it is chosen as the minimum value of 
 <span style="background-color:#f1f1f1">medium.c</span>.
 
 <br><br>2. <span style="background-color:#f1f1f1">reflection_order</span>
 indicates the maximum order of reflection to be included in the simulation. This number is 
 recommended to be 2 for lossy biological media in order to achieve the best tradeoff between accuracy and computation time.
 
 <br><br>3. For simulations with large speed of sound or density contrast (contrast ratio being larger than 1.05), 
 <span style="background-color:#f1f1f1">correction</span> is recommended.

 <br><br>4. For a heterogeneous medium, when using full-wave-solver-generated data or measured data as the input for backward projection, the mixed domain 
 method could produce spurious reflections. An algorithm, therefore, is designed to mitigate this issue. This correction 
 algorithm, however, roughly doubles the computational time. There are a few scenarios where this correction algorithm can be 
 disabled without sacrificing much of the accuracy. This can be done by activating "no_refl_correction". For example, 
 when multiple reflection is not considered in the backward projection, i.e., when "reflection_order"=0, the correction algorithm 
 can be turned off. Even if "reflection_order" is not equal to 0, the correction algorithm can be turned off for weakly 
 heterogeneous media such as soft tissue. 
 When the speed of sound and density are constants, the correcton algorithm will be turned off automatically.
 
 <br><br>5. By invoking <span style="background-color:#f1f1f1">NRL</span>, non-reflecting layers are added to the computational 
 domain and would minimize the spatial aliasing error. If the non-reflecting layer is activated,
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 must be given.
</p>

<h3>Outputs</h3> 

<p>
Pressure field distribution at the center frequency.    
</pr>


