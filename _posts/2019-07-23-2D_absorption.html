---
title: Reducing the spatial aliasing error using the non-reflecting layer
---
<p>
<br>
<hr>
<hr>
Adding non-reflecting layers can help reduce the spatial aliasing error by absorbing the 
energy at the boundaries. It must be noted that the acoustic field will become inaccurate 
if the absorption is set to be too strong. On the other hand, the spatial aliasing error 
cannot be significantly reduced if the absorption is too small. There is, therefore, a tradeoff. 
In this example, the effect of the non-reflecting layer is investigated by using different 
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>.
<hr>
<hr>
</p>


<!---2D forward Simulation--->
<h6>2D forward simulation</h6>
<hr>
<p>  
This simulation setup is based on the 
   <a href="https://m-sound.github.io/mSOUND/FSMDM_2D_homogeneous">
  Simulation of a 2D homogeneous medium using the frequency-specific mixed domain method</a>. Computational domain and simulation 
  setup are the same in the two examples. In this example, three pairs of 
 <span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha</span>
 are studied and they are: 
 <span style="background-color:#f1f1f1">medium.NRL_gamma=0.1</span> and <span style="background-color:#f1f1f1">medium.NRLb_alpha=0.5</span>,
 <span style="background-color:#f1f1f1">medium.NRL_gamma=0.5</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha=0.2</span>, and
 <span style="background-color:#f1f1f1">medium.NRL_gamma=0.8</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha=0.05</span>. 
 In the first figure, we show the absorption coefficient profiles along the transverse direction. "M_gamma" in Forward2D_fund is plotted. When 
 <span style="background-color:#f1f1f1">medium.NRL_gamma=0.1</span> and <span style="background-color:#f1f1f1">medium.NRLb_alpha=0.5</span>,
 absorption is too small to reduce the artifical reflections from the boundary. When
 <span style="background-color:#f1f1f1">medium.NRL_gamma=0.8</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha=0.05</span>,
 absorption is too strong and will give inaccurate acoustic field.
 The pressure distributions along the central axis with different absorption layer configurations are shown in the second figure below. 

<pre>
<code>
<font color="#03a852">% forward propagation of the fundamental pressure</font>   
P_fundamental = Forward2D_fund(mgrid, medium, excit_p, omega_c, 0, 'NRL');
</code>
</pre>
The axial pressure distributions for different 
<span style="background-color:#f1f1f1">medium.NRL_gamma</span> and <span style="background-color:#f1f1f1">medium.NRLb_alpha</span>
values are shown below. The benchmark is generated by using a sufficiently large computational domain. The spatial aliasing errors 
are manifested as the oscillations in the pressure distributions, which is minimized by using 
<span style="background-color:#f1f1f1">medium.NRL_gamma=0.5</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha=0.2</span>.
Using 
<span style="background-color:#f1f1f1">medium.NRL_gamma=0.8</span> and <span style="background-color:#f1f1f1">medium.NRL_alpha=0.05</span>
also reduces the spatial aliasing error. However, the comparison with the benchmark suggests that the acoustic field is 
inaccurate due to the excessive absorption.  
<img src="/mSOUND/img/FSMDM_2D_absorption_values.jpg" alt="absorption along the transverse direction">
<img src="/mSOUND/img/FSMDM_2D_absorption.jpg" alt="axial pressure distribution at x=0">
</p>



<h6>Other examples</h6>
<hr>
<p>
<br> <h7 style='font-weight:bold;'>&#11166;Forward TMDM</h7>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_2D_homogeneous">
    Simulation of a 2D homogeneous medium using the transient mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_2D_heterogeneous">
    Simulation of a 2D heterogeneous medium using the transient mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM-2D-strong-speed-of-sound-contrast">
    Simulation of a strongly 2D heterogeneous medium using the transient mixed domain method</a>  
<br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_3D_homogeneous">
    Simulation of a 3D homogeneous medium using the transient mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_2D_animation">
    Selecting the proper temporal domain size for the TMDM</a>  
<br>&middot;<a href="https://m-sound.github.io/mSOUND/TMDM_shock">
    Shock wave simulations with TMDM</a>   
 
<br><h7 style='font-weight:bold;'>&#11166;Forward FSMDM</h7>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM_2D_homogeneous">
    Simulation of a 2D homogeneous medium using the frequency-specific mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM_2D_heterogeneous">
    Simulation of a 2D heterogeneous medium using the frequency-specific mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM_3D_homogeneous">
    Simulation of a 3D homogeneous medium using the frequency-specific mixed domain method</a>
<br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM-3D_heterogeneous">
    Simulation of a 3D heterogeneous medium using the frequency-specific mixed domain method</a>
 <br>&middot;<a href="https://m-sound.github.io/mSOUND/2D_absorption">
    Reducing the spatial aliasing error using the non-reflecting layer</a>
  <br>&middot;<a href="https://m-sound.github.io/mSOUND/rigid_vs_pressure_release">
    Comparing pressure release and rigid boundary conditions</a>

 <br><h7 style='font-weight:bold;'>&#11166;Backward Propagation</h7>
 <br>&middot;<a href="https://m-sound.github.io/mSOUND/Backward_TMDM">
    Image reconstruction using backward projection</a>    
 <br>&middot;<a href="https://m-sound.github.io/mSOUND/FSMDM_3D_multi_sources">
    Reconstruction of the source pressure distribution with FSMDM in a 3D homogeneous medium</a>
 
 <br><h7 style='font-weight:bold;'>&#11166;Integration with Other Simulators</h7>
 <br>&middot;<a href="https://m-sound.github.io/mSOUND/combine-k-Wave-TMDM">
    Integrating mSOUND with k-Wave for transducers of arbitrary shape</a>
 <br>&middot;<a href="https://m-sound.github.io/mSOUND/combine-FOCUS-mSOUND">
    Integrating mSOUND with FOCUS for transducers of arbitrary shape</a> 
 <br>&middot;<a href="https://m-sound.github.io/mSOUND/combine-k-Wave-diffusion">
    Integrating mSOUND with k-Wave for thermal simulations</a> 
</p>
